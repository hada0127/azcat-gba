# 게임 스펙 상세

## 게임 상태 머신

```
STATE_TITLE → STATE_PLAY → STATE_GAMEOVER → (반복)
```

## 게임 변수

| 변수명 | 초기값 | 설명 | 범위 |
|--------|--------|------|------|
| `player_life` | 3 | 플레이어 HP | 0~3 |
| `score` | 0 | 현재 점수 | 0~ |
| `hiscore` | 0 | 최고 점수 (SRAM 저장) | 0~ |
| `player_accel` | 0 | 추가 이동속도 | 0~4 |
| `bomb_have` | 0 | 폭탄 보유 여부 | 0/1 |
| `bomb_use` | 0 | 폭탄 사용중 | 0/1 |
| `v_cat_qty` | 0 | 활성 고양이 수 | 0~43 |
| `v_cat_accel` | 1 | 고양이 추가 낙하속도 | 1~17 |
| `v_player_direction` | left | 플레이어 방향 | left/right |
| `item_type` | - | 아이템 종류 | 1~4 |
| `item_cnt` | 0 | 아이템 출현 카운터 | 0~150+ |

## 플레이어 시스템

- **스프라이트**: 32x32 OAM
- **상태**: `idle_left`, `idle_right`, `left`, `right`, `dead`
- **이동 공식**: `X += 5 + v_accel + player_accel`
  - `v_accel`: 누적 가속도, +0.2/프레임, 키 떼면 리셋
  - `player_accel`: 아이템으로 증가 (최대 4)
- **조작**: 키 홀드 = 이동, 키 릴리스 = 즉시 정지 (원본과 다름)
- **X 범위**: 0 ~ 216 (GBA)
- **초기 위치**: X = 108 (화면 중앙)
- **폭탄 사용 중**: 이동 불가
- **좌우 전환**: OAM hflip 사용

## 고양이 시스템

- **총 수**: 33개 배열 (cat[0] ~ cat[32])
- **구조체**: `{ x, y, v_accel, active, state }`
- **스폰**: 랜덤 X(1~224), Y(-20~-120)
- **낙하**: `Y += 1 + v_accel + v_cat_accel` (v_accel += 0.5/프레임)
- **착지**: Y > 136 → score += 1, "sit" 상태
- **충돌**: Y 116~136 구간, 플레이어 히트박스와 X축 겹침
- **피격**: `player_life -= 1`, 해당 고양이 제거
- **폭탄**: `bomb_use == 1`이면 모든 고양이 즉시 제거
- **활성화**: `v_cat_qty`로 제어
- **OAM**: 16x16 스프라이트 × 33개

## 아이템 시스템

- **출현 조건**: `item_cnt > 149` (약 150프레임 = 2.5초@60fps)
- **스폰**: 랜덤 X(1~224), Y = -24
- **낙하**: `Y += 1 + v_accel` (v_accel += 0.5)
- **바닥 체류**: Y=140 정지, 45프레임 후 소멸

### 아이템 효과

| 타입 | 이름 | 효과 | 초과시 |
|------|------|------|--------|
| i1 | 체력회복 | HP+1 (최대 3) | score+5 |
| i2 | 전멸폭탄 | bomb_have=1 (최대 1) | score+5 |
| i3 | HP감소 | HP-1 (최소 1, 사망 안함) | score-5 |
| i4 | 속도업 | player_accel+1 (최대 4) | score+5 |

## 폭탄 시스템

- **발동**: L버튼 + `bomb_have==1`
- **효과**: 모든 고양이 즉시 제거
- **지속**: ~20프레임 (원본 41프레임에서 단축)
- **제약**: 사용 중 플레이어 이동/고양이 낙하 정지
- **OAM**: 32x32 폭발 이펙트 애니메이션

## 타이틀 화면

- 배경: Mode 4 비트맵
- HISCORE 표시 (SRAM 로드)
- 입력: START/→ = 게임시작

## 게임오버 화면

- 배경 어둡게 (반투명 오버레이)
- 등급명 + 점수 중앙 표시
- 입력: ← = 타이틀, → = 재도전
- 하이스코어 갱신 시 SRAM 저장

## GBA 조작 매핑

| GBA 버튼 | 동작 |
|----------|------|
| D-Pad Left | 좌 이동 (홀드) / 타이틀로 |
| D-Pad Right | 우 이동 (홀드) / 게임시작, 재도전 |
| L 버튼 | 전멸 폭탄 사용 |
| START | 게임 시작 (타이틀) |
